# Social blocs, socio-economic factors and voting outcomes in Switzerland


## The traditional Swiss bourgeois and left blocs: historical perspectives

A striking feature of the history of Switzerland's social blocs is the persistence and resilience of a liberal-right bloc since the creation of modern Switzerland in 1848, a bloc that the existing literature on the topic calls the *bourgeois bloc*. Tracing the history of Switzerland's social blocs is therefore essentially a matter of tracing that of the bourgeois bloc. However, we shall see that tracing this history calls into question the extent to which this bourgeois bloc can truly be described as bourgeois.

The history of the Swiss bourgeois bloc goes back to the creation of modern Switzerland. The combination of a religious and urban-rural divide between Radicals-Protestants modernizers and Catholic federalists, which was historically one of the most structuring conflicts in Switzerland, led to the Sonderbund civil war (1847) and the foundation of modern Switzerland in 1848. The federal institutions elaborated during and in the decades following the first Swiss constitution of 1848 can be interpreted as a social compromise between the losers of the Sonderbund civil war, the Catholic-Conservative coalition opposed to the centralization and modernization of the Swiss Confederation, and the victorious Radicals who were on average Protestants and bourgeois from urban areas [@sciarini_politique_2023]. However, these two blocs were highly heterogeneous and subject to internal contradictions.

From the outset of their movement, the Radicals were gathered by an unitary illusion: the pretention to transcend cleavages running through Swiss society and unite all its elements thanks to an encompassing goal: the modernization and centralization of the Swiss state. Far from homogenous, the Radical bloc was a kaleidoscopic mass-movement constituted by the working class through the Grütli Union and by an elite gathering entrepreneurs, bankers, journalists, lawyers and teachers, who were nonetheless divided over the role of the Swiss state. The Democrats were partisans of a more centralized and interventionist state while the liberal or "manchesterian" Radicals, were more federalist and in favor of laissez-faire. This divide between interventionists and liberals was made explicit as early as 1852 over the issue of the nationalization of the Swiss railway industries. Supporters of a state-run railroad network, represented by for instance Jakob Stämplfi and Johann Jakob Speiser, were opposed by liberal Radicals such as Alfred Escher, who were industrialists and bankers close to the private railway companies, when they weren't the owners themselves [@meuwly_les_2010].

Regarding the Catholic-Conservative bloc, the latter was from the start a cross-class coalition, constituted by, of course, the Catholic elite, but also by peasants, farmers, artisans and the commercial middle class from rural areas. These groups were united by Catholicism, but also by anti-modernism and federalism. This conservative coalition was the first to make extensive use of the constitutional and optional referendum (respectively 1848 and 1874) to block the modernization promulgated by the Radicals. While the Radicals were convinced that the idea of the Swiss nation would transcend divisions and social conflict, the Catholic-Conservative believed that religion, rather than the Swiss state, would endorse this role [@altermatt_conservatism_1979].

As industrialization, proletarianization and unionization intensified in the late 19th, the hegemony of the Radical mosaic gradually shattered. Part of the democrats and of the working class joined or even founded socialist organizations, as seen the creation of the Swiss socialist party in 1888 by a former Radical, Albert Steck. The creation of the latter and of the Radical-democratic party (PRD) in 1894 marked the beginning of the Radical shift towards liberal stances, which became clear-cut after the general strike of 1912, after which "a long-denied class conflict became evident" [@meuwly_les_2010, p.49]. Conversely, industrialization and class conflict represented an opportunity for an extension of the social basis of the Catholic-Conservatives bloc towards the working class. The global development of a Catholic social doctrine, beginning with the encyclical *Rerum Novarum* (1881), was integrated by the Swiss Catholic-Conservatives, who then tried to attract parts of the working class [@altermatt_conservatism_1979].

This polarization around class conflict between a left and right bloc became even more salient after the second general strike of 1918, which was the biggest strike and social protest in Swiss history. The latter was followed by the introduction of the proportional representation system: the Radicals lost their hegemony in the parliament and the Christian-Democrats and the Socialists became important political actors in the National Council. The Socialist Party (PS) consolidated a left bloc while the Radical-Democrats (PRD), the Christian-Democrats (PDC) and the Agrarians formed an alliance against the left. This coalition between the PRD, PDC and Agrarians and its close links with business association such as the Vorort (1870) led many observers to name this dominant coalition the "bourgeois bloc" [@mach_redefinition_2007]. 

However, the extent to which this dominant bloc can truly be described as bourgeois must be questioned. In the definition given by Swiss social scientists, the bourgeois bloc refers to a political coalition between the Radical-Democrats, the Christian-Democrats and the Agrarians (now UDC) and its close ties with business interest associations. This bloc is hence bourgeois only because it gathers right-wing parties and business interest associations, a definition which is rather narrow and can be misleading since it does not take into account the social basis of the bloc. Calling the right-wing coalition bourgeois ignores, for instance, the fact that this bloc gathered some popular socio-economic groups such as small-business owners and peasants, mainly through the Agrarian Party. In the sense given by Amable and Palombarini, the bloc bourgeois observed in France corresponds to the aggregation of the wealthiest and most educated groups of the traditional left and right blocs. I argue that, from a neorealist perspective, the Radical bloc of the 19th century and the right-wing coalition of the 20th cannot be described as bourgeois and that other terms such as "liberal-conservative" or simply "right-wing" blocs are more suited. 

In fact, until the post-war period, the evolution of the Swiss social blocs can thus be resumed as follows. From the middle to the late 19th century, the Radicals formed a strongly heterogeneous but dominant social bloc. This dominant social bloc was composed by the working class (mainly through the Grütli Union), and an urban elite composed by the most educated (journalists, lawyers, teachers) and the wealthy industrial bourgeoisie (entrepreneurs, bankers...). This DSB was united by their willingness to modernize the Confederation against the Catholic-Conservatives. A second period, from the late 19th to the second World War, marked the recomposition of the DSB and its transformation into a liberal-conservative political bloc. Part of the working class and of the democrats (educated elite) joined the emerging socialist-left bloc while the Christian-Democrats attracted part of the working class while being progressively incorporated into the DSB, along with the Agrarian party which represented the peasant and farmer classes.

Analyses of the first Swiss post-electoral surveys which were conducted in the 1970s show the heterogeneity of the Swiss "bourgeois bloc" and that the word bourgeois is not valid for the right bloc as a whole. The social basis of the Liberal-Radical party was constituted by large employers/liberal professions and managers. The UDC relied heavily on small business owners' support while the PDC's social basis was rather cross-class [@rennwald_class_2014; @tawfik_les_2019]. Therefore, of the three right-wing government parties, only the Liberal-Radical party's social basis can truly be described as bourgeois. Regarding the support for the Socialist party, the latter was neither a bourgeois nor solely a popular party, but a hybrid-class party whose social basis was constituted by socio-cultural professionals and production workers [@rennwald_social_2020]. 

The coalition between the Radical-Democrats, Christian-Democrats and Agrarians against the left bloc took deeply roots into the Swiss socio-political system: it persisted during the post-war period and still shapes Swiss politics to some extent nowadays [@mazzoleni_voisinages_2013; @meuwly_les_2010; @meuwly_liberte_2008]. A striking feature of the Swiss DSB is its persistence and resilience since 1848: even though this bloc underwent important transformations, especially after the introduction of the proportional system in 1918, it was always mediated by right-wing parties, first the Radicals and then an extended coalition with the Catholic-Conservative and the Agrarians. Despite its incorporation in the parliament and government, the left bloc never truly became dominant in Switzerland. 

However, since the break-up of the post-war Keynesian "historical compromise" between the traditional Swiss left and right-wing parties during the so-called "decade of all dangers" of the 90s [@boschetti_conquete_2007], this so-called bourgeois bloc is undergoing important transformations, that some authors interpreted as various forms of latent political crises. The Swiss political scene is still marked by the rise of the Swiss People Party (UDC), one of the most successful far-right populist parties in Europe. The electoral success of the UDC is often associated with the destabilization of the traditional bourgeois bloc, which entered a phase of "cacophonic" crisis [@meuwly_liberte_2008] which still persists in the early 2020s. 

```{r set up}
#| echo: false
#| warning: false
#| message: false

library(irr)
library(JuliaCall)
library(JuliaConnectoR)
library(tidyverse)
library(haven)
library(quarto)
library(sjlabelled)
library(readr)
library(readxl)
library(haven)
library(viridis)
library(stargazer)
library(gtsummary)
library(gt)
library(brms)
library(ggrepel)
library(cowplot)
library(ggpubr)
library(lme4)
library(prediction)
library(marginaleffects)
library(ggeffects)
library(ordinal)
library(broom)
library(knitr)
library(readr)
library(gtExtras)
library(broom.mixed)
library(GGally)
library(questionr)
library(car)
library(effects)
library(sjPlot)
library(margins)
library(cAIC4)
library(ordinal)
library(pacman)
library(easystats)
```

```{r party share graph}
#| warning: false
#| message: false
#| echo: false
#| fig-cap: "Party Strength: 1918-2019"
#| label: fig-partystrength
party_share <- read_excel(path = "/master-thesis/data/force_parti_ofs.xlsx",
                          sheet = 2)
party_share[party_share == "*"] <- NA
party_share <- data.frame(lapply(party_share, as.numeric))

party_share_long <- 
party_share  %>% 
  pivot_longer(cols = !`...1`,
               names_to = "party",
               values_to = "Party_strength") %>% 
  rename(year = "...1")

party_share_long %>% 
  filter(party %in% c("PLR..PRD..3.", "PDC", "PS", "UDC", "PES")) %>% 
  ggplot()+
  aes(x = year, y = Party_strength, color = party, shape = party)+
  scale_x_continuous()+
  geom_line()+
  geom_point()+
  theme_bw()+
  scale_color_brewer(palette = "Set1")

```

In fact, all the Swiss traditional main parties, the Swiss Socialist Party (PS) The Radical-Liberals (PLR) and the PDC, are in decline since the post-war period (see @fig-partystrength). On the right, the crisis can be seen through the fall in vote shares (apart from the SVP); and the increase in party merges and re-configurations. In 2008, the Bourgeois Democratic Party (PBD) was created after a scission from the SVP. One year later, the Radicals, who created the Swiss modern state in 1848 and dominated Swiss politics until the first half of the 20th century, merged with the liberals to create the PLR. The PBD, whose creation disturbed the composition of a reputed unchangeable federal council, then merged with the PDC to create *Le Centre* (the Center) in 2021. The federal election of 2023 led to major historical change for the Swiss right. The PLR, very far from its former hegemonic domination of Swiss politics, is now in the fourth place in terms of low chamber parliamentary seats.



## Swiss social blocs and socio-economic factors: 1980-2016

How have the social bases of the Swiss left, center-right and radical-right evolved since the 70s? How are the support for the main Swiss social blocs influenced by socio-economic characteristics? The objective of this chapter is to explore the composition of the main Swiss social blocs in terms of socio-economic characteristics and assess their evolution since the post-war period. The previous chapter asked whether the periods of political instability measured through confidence in the Swiss government in the 1990s and early 2005 can be interpreted as a political crisis. By exploring the support for the main Swiss parties since 1981, this question can be partially answered, as well as the main research question of the present paper.

Moreover, a recent trend in political economy developed a tremendous analysis of the long run transformations of political cleavages, social blocs, and voting outcomes in almost all democratic countries around the world. The popularity of inequality studies, after the contributions of renown economists such as Atkinson [-@atkinson_inequality_2015], Milanovic [-@milanovic_global_2016] and of course Piketty [@piketty_capital_2014], economists recently became interested in the problematic of social conflict and political cleavages. One possible explanation of this sudden interest is the inequality paradox: increasing inequality and neoliberal reforms did not pave the way for growing support for redistribution, taxation of top income and wealth owners, or for left parties. The same paradox could be applied to a "climate change paradox", that is, the fact that the growing emergency or environmental issues were not followed by increasing support for green parties. For instance, the Swiss green parties were the biggest losers in the 2023 federal elections.

Those paradox thus gave way to a recent literature linking political cleavages and voting outcomes as function of a set of socio-economic factors, mainly income and education level. Trying to explore this inequality paradox, @piketty_brahmin_2018 underlines the fact that, rather than bringing back class-based divide back to its post-war salience, the global rise in inequality since the 1970s was followed by the emergence of a new cleavage and a multi-elite party system. During the post-war period, the electoral support for the left parties in The US, UK and France was mainly constituted by popular classes with low income and education levels whereas right-wing parties were supported by high income and education voters. The popular element of the support for the left blocs then transformed in the 1970-80s: left parties became the bloc of the highly educated, thus becoming the "brahmin right", whereas the right kept the support of the wealthy ("merchant right") [@piketty_brahmin_2018; @piketty_capital_2019]. A further project, which gave birth to the World Political Cleavage and Inequality Database (WPID), showed that these transformations affected almost all Western democracies [@gethin_political_2021].

Underlying the rise of a new cleavage in the 70s and 80s, Piketty and the WPID tackle a topic which is well-known in political science: the emergence of a cleavage centered around cultural values, that Piketty calls the "nativists-internationalists" divide, which cuts across the traditional class conflict and is the result of the increase in average education level and of globalization. The combination of this new cultural cleavage with the traditional class-based conflict draws a bi-dimensional political space in which four social blocs are possible: an internationalist-egalitarian bloc which is on the left both culturally and economically; an internationalist-inegalitarian bloc on the left culturally but economically on the right; a nativist-inegalitarian bloc on the right culturally and economically; and a nativist-egalitarian bloc which is culturally conservative but economically on the left [@piketty_brahmin_2018; @piketty_capital_2019]. This "cultural cleavage" has been given as many labels as it has analysts among political scientists: "materialist-postmaterialist" divide for Inglehart [-@inglehart_silent_1971; -@inglehart_value_1987; -@inglehart_culture_1990]; the "libertarian-authoritarian" cleavage [@kitschelt_transformation_1994; @flanagan_new_2003];
winners vs losers of globalization [@kriesi_globalization_2006; @kriesi_west_2008; @teney_winners_2014]; the "transnational cleavage" [@hooghe_cleavage_2018] or the "universalism–particularism" cleavage [@bornschier_cleavage_2010; @zollinger_cleavage_2022]. 

Testing the relevance of the brahmin left vs merchant right divide, @amable_brahmin_2022 offer contrasting results. On the one hand, preference for redistribution decreases with both education and income levels. On the other hand, support for globalization (such as immigration) is not only structured by education level, but also positively associated with income. @amable_brahmin_2022 suggest the possibility of a rapprochement between the brahmin left and the merchant right, giving birth to a bourgeois bloc uniting the wealthiest and most educated groups from the left and the right. @amable_brahmin_2022-1 show that the brahmin left vs merchant right divide has not taken place in every country and that the classical popular left versus bourgeois right opposition is still relevant for many countries.

In this context of multi-elite party system and multidimensional political divides, Switzerland is an interesting case study. A widespread idea claims that the class-based cleavage always played relatively a minor role in Switzerland. On the one hand, class conflict was always cut across a wide variety of other divides: religious, linguistic or regional. As a result, Switzerland was a forerunner in the emergence of this "cultural" cleavage, but also in the precociousness and strength of the educational shift. @durrer_de_la_sota_party_2021 offer a detailed analysis of the links between socio-economic factors and the vote for the main Swiss social blocs. During the post-war period until the 1990s, the left bloc (mainly the PS) was supported by low income and education voters while right-wing parties showed different patterns of class support, which call into question the extent to which this bourgeois bloc can truly be characterized as "bourgeois". Of the three parties constituting the bourgeois bloc, only one of them, the PRD-PLR party, had clearly a bourgeois composition since it is consistently supported by the most wealthy and educated groups since the post-war period. The PDC and the UDC cannot really be described as "bourgeois" since, according to @durrer_de_la_sota_party_2021, the support for the two parties was negatively associated with income and education. While this negative association tends to decline for the PDC, it became even more strong for the UDC since the 90s. After this period, the left bloc became "brahmin" in the sense that it gathered strong support among the most educated classes, while its popular support moved either into abstention or to the UDC.

The transformation of party systems into a mutli-elite and tripolar political space came with important change in the structural basis of party support. @oesch_class_2010 show that, in Switzerland, the cultural cleavage is rooted in the class structure, and caused a re-alignment between class and party support. Before this shift took place, the traditional left bloc politically represented by the Socialist Party was a hybrid-class coalition gathering socio-cultural professionals (teachers, academics, journalists...) and production workers, but also from technicians, clerks and service workers [@rennwald_social_2020].

This strong class heterogeneity of the Swiss left declined: an analysis of Swiss post-election surveys for 2003 and 2007 show that the Swiss left was deserted by production workers who directed their support for the Swiss People's party due to cultural issues [@oesch_class_2010]. Using European Social Survey data for 2011 and 2015, @rennwald_social_2020 show that socio-cultural professionals remain the only "party preserve" of the Swiss left.

@oesch_electoral_2018 show that the rise of the radical-right and of the cultural cleavage transformed the patterns of class voting. The working class, or at least some of its constituencies such as production workers, are still attracted to the left due to their economic interests, but also by the far-right because of cultural issues, leaving socio-cultural professionals as the sole "stronghold" of the left. Small artisans and business owners are also divided between their support to the center-right and the far-right: their economic preferences make them closer to the center-right while their cultural preferences are closer to the far-right. 

The empirical agenda of the present study is to test the validity and relevance of the literature reviewed above. More specifically, how are socio-economic factor shaping the composition of each Swiss social blocs? The objective of the empirical analysis conducted here is to test the following hypotheses derived from the contributions of the WPID project [@piketty_brahmin_2018; @piketty_capital_2019; @durrer_de_la_sota_party_2021; @gethin_political_2021; @gethin_brahmin_2022]; @oesch_electoral_2018; and Amable and Darcillon [-@amable_brahmin_2022; -@amable_brahmin_2022-1]:

1. *Brahmin left versus merchant right hypothesis*

    Over time, the association between education and support for the left should increase while a negative and decreasing link between income and support for the left should be observed. A positive relationship between support for the right and income should remain rather stable, with no clear or negative association and evolution with education level.
    
2. *Bourgeois bloc hypothesis*

    The support for right parties increases with both income and education levels. Popular groups support either the nativist far-right bloc (SVP) or abstention.
    

### Data and empirical strategy 

To test the hypotheses above, two types of data are especially relevant. The *Swiss Election Studies (SELECTS) cumulative dataset* is a harmonized dataset merging every Swiss post-election (federal assembly elections, which take place every four years) surveys from 1971 to 2019 [@tresch_swiss_2022]. Since SELECTS data are already drastically analyzed by the literature (for instance by @durrer_de_la_sota_party_2021), I contribute to the existing research by analyzing another data source, the *VoxIt* cumulative dataset which harmonize every post-vote surveys from 1981 to 2016 [@brunner_enquetes_2017].

The main dependent variables are binary variables for party support while the two main explanatory variables are income and education levels. The income variable needed some recoding since the scale of the variable changed in 1991: "nivmena" is a four scale variables on the respondent's standard of living, while "revenu" is a more standard income variable in five categories. In order to have significant and robust results, years are grouped into categories of two. The cumulative dataset offers few variables which a few missing value rates across the years and can be added as control variables: age (recoded into categories), gender and house ownership.

The main methodological challenge of these two repeated cross-sectional datasets (RPC) is the clustering structure of the data. On the one hand, the observations (Swiss citizen) are clustered into cantons, which are an important level in Switzerland. On the other hand, the time structure and trend of the data are highly relevant for our research question. 

To face this challenge, multilevel binary probit regressions are run for each Swiss main parties (PRD-PLR, PS, UDC, PDC, Greens) and abstention (if the respondent declared not feeling close to any party). In our case study, multilevel/hierarchical models offer several advantages and relevant properties. On the one hand, they allow to take regions (here Swiss cantons) and time as levels in which observations are nested. Taking cantons as a level is especially relevant for Switzerland, in which every day political life, institutions and party system are highly decentralized, federalist and organized at the cantonal level. Each canton has its own specific institutions and can show very different patterns of party support and party system. For instance, some parties exist solely at the cantonal level, like the *Mouvement Citoyen Genevois* (*Genevan Citizen Movement*, MCG) or the *Lega Ticinesi*. On the other hand, taking into account the multilevel structure of the data allow better inference and, parameters and standard errors estimations [@julian_consequences_2001; @steenbergen_modeling_2002].

To analyze the time trend, two approaches are possible. One possible approach is to run regressions separately for each year, and then plot estimates to see their trend over time. This "repeated cross-sectional" multilevel regression design is used for instance in @gelman_rich_2007 classic study which explores the links between income and party support in the US to uncover the "rich states, blue states" paradox, the fact that, at the state level, richer states support the democrats while, at the national (individual) level, richer voters still support the Republican. By Using this "secret weapon", @gelman_rich_2007 showed that this paradox is the result of varying strength of association between income and party support across states: in poor states, the link between income and support for republican is higher than in rich states. Another possible approach is to consider time as level per se: instead of running separate regressions for each year, time can be modeled directly as a level [@gelman_data_2006]. However, even though Switzerland is a highly federalist and decentralized country, it is possible that cross-canton variations may not be much important or at least not as important as in the US. One reason is that cross canton inequalities are not so high as in the US. Another reason is that another level may be even more important than the cantonal level: the communes.

In the present study, only the second approach will be considered: regressions are run for each party with income and education as the main explanatory variables and cantons and years as levels. Slopes are allowed to vary at the cantonal and year levels.



```{r import voxit}
#| echo: false
#| message: false
#| warning: false

vox <- read_sav("data/voxit.sav")
```

```{r create income and educ variable}
#| warning: false
#| message: false
#| echo: false

# Two ways to create the income variable
vox <- vox %>% 
  mutate(income = if_else(revenu == 1 & is.na(nivmena), 4,
                          if_else(revenu == 2 & is.na(nivmena), 3,
                                  if_else(revenu %in% c(3,4) & is.na(nivmena), 2,
                                          if_else(revenu == 5 & is.na(nivmena), 1,
                                                  if_else(is.na(revenu) & annee <= 1993, nivmena, NA))))))

         
vox$income <- ifelse(vox$income == 4, -1,
                    ifelse(vox$income == 3, 0,
                        ifelse(vox$income == 2, 1,
                          ifelse(vox$income == 1, 2, NA)))) # centering around zero, this will make the intercept more interpretable 


# for education, rescale the values so that the lowest level is equal to zero
vox <- vox %>% 
  mutate(education = case_when(
    educ == 1 ~ 0,
    educ == 2 ~ 1,
    educ == 3 ~ 2,
    educ == 4 ~ 3,
    educ == 5 ~ 4,
    educ == 6 ~ 5,
    is.na(educ) ~ NA
  ),
  educationf = case_when(
    educ == 1 ~ "comp_school",
    educ == 2 ~ "voc_training",
    educ == 3 ~ "maturity",
    educ %in% c(4,5,6) ~ "University",
    is.na(educ) ~ NA
  ),
  incomef = case_when(
    income == -1 ~ "low",
    income == 0 ~ "middle_low",
    income == 1 ~ "middle_high",
    income == 2 ~ "high"
  ))

vox$educationf <- relevel(factor(vox$educationf), ref = "voc_training")
vox$incomef <- relevel(factor(vox$incomef), ref = "low")
```

```{r party dummies and other recoding}
#| warning: false
#| message: false
#| echo: false

vox$pss <- ifelse(vox$p02 == 12, 1,
                  ifelse(is.na(vox$p02), NA, 0))

vox$udc <- ifelse(vox$p02 == 13, 1,
                  ifelse(is.na(vox$p02), NA, 0))

vox$plr <- ifelse(vox$p02 == 20, 1, ### le parti radical democratique fusionne avec le parti liberal en 2009
                  ifelse(vox$p02 == 4, 1,
                  ifelse(is.na(vox$p02), NA, 0)))

vox$green <- ifelse(vox$p02 == 6, 1,
                  ifelse(is.na(vox$p02), NA, 0))

vox$pdc_pcs <- if_else(vox$p02 %in% c(0, 1, 2), 1,
                       if_else(is.na(vox$p02), NA, 0))

vox$no_party <- if_else(vox$p02 %in% c(33), 1,
                       if_else(is.na(vox$p02), 1, 0))


vox$gender <- factor(vox$sexe, levels = c(1, 2), labels = c("male", "female"))
vox$married <- ifelse(vox$etatciv == 2, 1,
                      ifelse(is.na(vox$etatciv), NA, 0))

vox$regionL <- as_character(vox$regiling)
vox$religion <- relevel(factor(as_character(vox$confess)), ref = "Catholique romain")

## recoding age in 4 categories

vox$age_cat <- cut(vox$age, c(13, 30, 45, 65, 99), right = FALSE, include.lowest = TRUE)

vox$annee_cat <- cut(vox$annee, seq(from = 1981, to = 2016, by = 5), right = TRUE, include.lowest = TRUE)
vox$annee_f <- factor(vox$annee)

vox$canton <- as_character(vox$canton)


vox$house_ownership <- if_else(vox$statloge == 1, 1, 0)

### classes sociales dummies selon le secteur du répondant (posprof) ou du chef du menage (s31) sauf pour public
vox <- 
  vox %>% 
  mutate(
    farmer = if_else(posprof == 1 | s31 == 4, 1, 0), 
    self_employed = if_else(posprof == 2 | s31 == 1, 1, 0),
    ouvrier = if_else(posprof == 7 | s31 == 5, 1, 0),
    public = if_else(posprof == 6, 1, 0),
    atheist = if_else(confess == 4, 1, 0),
    protestant = if_else(confess == 1, 1, 0),
    catholic = if_else(confess %in% c(2, 5), 1, 0),
    lr = as.ordered(p04),
    
    left = if_else(p04 %in% c(0,1,2,3,4), 1,
                   if_else(is.na(p04), NA, 0)),
    center = if_else(p04 %in% c(5), 1,
                   if_else(is.na(p04), NA, 0)),
    right = if_else(p04 %in% c(6,7,8,9,10), 1,
                   if_else(is.na(p04), NA, 0)),
    stateint = if_else(val11 %in% c(1,2,3), 1,
                       if_else(is.na(val11), NA, 0)),
    redistribution = if_else(val5 %in% c(5,6,7), 1,
                       if_else(is.na(val5), NA, 0)),
    equal_rights_chforeign = if_else(val9 %in% c(1,2,3), 1,
                       if_else(is.na(val9), NA, 0))
    
  )

voxlr <- vox %>% filter(annee >= 1990)
freq(vox$val9)
freq(vox$center)
```

```{r run regressions}


reg_ps <- glm(data = vox, pss ~incomef*educationf + incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL + married + house_ownership, family = binomial(link = "logit"))

reg_plr <- glm(data = vox, plr ~incomef*educationf+ incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL+ married + house_ownership, family = binomial(link = "logit"))

reg_pdc <- glm(data = vox, pdc_pcs ~incomef*educationf +  incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL + married + house_ownership, family = binomial(link = "logit"))

reg_udc <- glm(data = vox, udc ~incomef*educationf +  incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL+ married + house_ownership, family = binomial(link = "logit"))

reg_greens <- glm(data = vox, green ~incomef*educationf +  incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL+ married + house_ownership, family = binomial(link = "logit"))

reg_abstention <- glm(data = vox, no_party ~ incomef*educationf + incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL+ married + house_ownership, family = binomial(link = "logit"))

reg_lr <- clm(data = voxlr, lr ~ incomef*educationf*annee_cat + gender + age_cat)
reg_lrols <- lm(data = voxlr, p04 ~ incomef*educationf*annee_cat + gender + age_cat)

reg_left <- glm(data = voxlr, 
                left ~ incomef*educationf +  incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL)

reg_state <- glm(data = voxlr, 
                stateint ~ incomef*educationf +  incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL + married + house_ownership)

reg_redistr <- glm(data = voxlr, 
                redistribution ~ incomef*educationf +  incomef:annee_cat + educationf:annee_cat + annee_cat + gender + age_cat + religion + regionL + married + house_ownership)

ame_left_inc <- 
  reg_left %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

ame_left_educ <- 
  reg_left %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

ame_left <- rbind(ame_left_educ, ame_left_inc)


ame_state_inc <- 
  reg_state %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

ame_state_educ <- 
  reg_state %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

ame_state <- rbind(ame_state_educ, ame_state_inc)

########ps
ps_ame_inc <- 
  reg_ps %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

ps_ame_edu <- 
  reg_ps %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

ps_ame <- rbind(ps_ame_edu, ps_ame_inc) %>% 
  mutate(party = "ps")

######plr
plr_ame_inc <- 
  reg_plr %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

plr_ame_edu <- 
  reg_plr %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

plr_ame <- rbind(plr_ame_edu, plr_ame_inc) %>% 
  mutate(party = "plr")
####### pdc
pdc_ame_inc <- 
  reg_pdc %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

pdc_ame_edu <- 
  reg_pdc %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

pdc_ame <- rbind(pdc_ame_edu, pdc_ame_inc) %>% 
  mutate(party = "pdc")

######### udc
udc_ame_inc <- 
  reg_udc %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

udc_ame_edu <- 
  reg_udc %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

udc_ame <- rbind(udc_ame_edu, udc_ame_inc) %>% 
  mutate(party = "udc")

###### greens
greens_ame_inc <- 
  reg_greens %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

greens_ame_edu <- 
  reg_greens %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

greens_ame <- rbind(greens_ame_inc, greens_ame_edu) %>% 
  mutate(party = "greens")

###### noparty

noparty_ame_inc <- 
  reg_abstention %>% 
  avg_slopes(variables = c("incomef"), by = c("annee_cat"))

noparty_ame_edu <- 
  reg_abstention %>% 
  avg_slopes(variables = c("educationf"), by = c("annee_cat"))

noparty_ame <- rbind(noparty_ame_inc, noparty_ame_edu) %>% 
  mutate(party = "noparty")

ame <- rbind(ps_ame, udc_ame, plr_ame, pdc_ame, greens_ame, noparty_ame)



####### lr 
```

```{r ame parties}
#| echo: false
#| message: false
#| warning: false
ame %>% 
  filter(contrast %in% c("mean(high) - mean(low)", "mean(University) - mean(voc_training)")) %>%
  filter(party %in% c("ps", "greens", "noparty", "plr")) %>% 
  ggplot()+
  aes(x = annee_cat, y = estimate, color = contrast, shape = contrast, group = party)+
  geom_point()+
  geom_pointrange(aes(ymin = conf.low, ymax = conf.high))+
  labs(title = "Party Support: Average Marginal Contrasts",
       subtitle = "Income and Education levels, Switzerland 1981-2016",
       x = "", y = "", caption = "Source: VoxIt")+
  theme_bw()+
  scale_y_continuous(labels=scales::percent)+
  geom_hline(yintercept = 0)+
  facet_wrap(~party)+
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))

ame %>% 
  filter(contrast %in% c("mean(high) - mean(low)", "mean(University) - mean(voc_training)")) %>%
  filter(party %in% c("pdc", "udc")) %>% 
  ggplot()+
  aes(x = annee_cat, y = estimate, color = contrast, shape = contrast, group = party)+
  geom_point()+
  geom_pointrange(aes(ymin = conf.low, ymax = conf.high))+
  labs(title = "Party Support: Average Marginal Contrasts",
       subtitle = "Income and Education levels, Switzerland 1981-2016",
       x = "", y = "", caption = "Source: VoxIt")+
  theme_bw()+
  scale_y_continuous(labels=scales::percent)+
  geom_hline(yintercept = 0)+
  facet_wrap(~party)+
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))


ame_left %>% 
  filter(contrast %in% c("mean(high) - mean(low)", "mean(University) - mean(voc_training)")) %>%
  ggplot()+
  aes(x = annee_cat, y = estimate, color = contrast, shape = contrast)+
  geom_point()+
  geom_pointrange(aes(ymin = conf.low, ymax = conf.high))+
  labs(x = "", y = "", caption = "Source: VoxIt")+
  theme_bw()+
  scale_y_continuous(labels=scales::percent)+
  geom_hline(yintercept = 0)+
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))

ame_state %>% 
  filter(contrast %in% c("mean(high) - mean(low)", "mean(University) - mean(voc_training)")) %>%
  ggplot()+
  aes(x = annee_cat, y = estimate, color = contrast, shape = contrast)+
  geom_point()+
  geom_pointrange(aes(ymin = conf.low, ymax = conf.high))+
  labs(x = "", y = "", caption = "Source: VoxIt")+
  theme_bw()+
  scale_y_continuous(labels=scales::percent)+
  geom_hline(yintercept = 0)+
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 50, vjust = 1, hjust=1))

```



























