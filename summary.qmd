# Summary



```{r}
#| echo: false
#| warning: false
#| message: false
rm(list = ls())
library(tidyverse)
library(haven)
library(quarto)
library(sjlabelled)
library(corrplot)
library(FactoMineR)
library(factoextra)
library(ade4)
selects1995 <- read_sav("data/64_Selects1995_PES_Data_v1.2.sav")
selects <- read_sav("C:/Users/celal/OneDrive/Bureau/master-thesis/data/495_Selects_CumulativeFile_Data_1971-2019_v2.3.0.sav")
```


```{r}
selects1975 <- 
  selects %>% 
  filter(year == 1975)

selects1975 %>% count(ip6)
```


```{r}
#| echo: false
#| warning: false


selects1995 %>%
  filter(canton == 8) %>% 
  select(matches("val[1-9]"), q179, q103) %>% 
  cor(method = "spearman", use = "pairwise.complete.obs") %>% 
  corrplot.mixed(order = 'hclust')

```


```{r}
datamca <- 
  selects1995 %>% 
  select(matches("val[1-9]"), classh) %>% 
  as_character() %>% 
  as_factor() %>% 
  drop_na()
```


```{r}
mca <- MCA(datamca)
fviz_cos2(mca, choice = "var", axes = 2)
fviz_mca_var(mca, col.var = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE, # avoid text overlapping (slow)
             ggtheme = theme_minimal()
             )
```










